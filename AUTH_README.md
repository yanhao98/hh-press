# RSPress è·¯ç”±æ‹¦æˆªè®¤è¯åŠŸèƒ½ ğŸ”

## åŠŸèƒ½è¯´æ˜

æ­¤åŠŸèƒ½ä¸º RSPress æ·»åŠ äº†è‡ªå®šä¹‰è·¯ç”±æ‹¦æˆªï¼Œç”¨äºä¿æŠ¤ç‰¹å®šé¡µé¢çš„è®¿é—®ã€‚å½“ç”¨æˆ·å°è¯•è®¿é—®å—ä¿æŠ¤çš„é¡µé¢æ—¶ï¼Œç³»ç»Ÿä¼šå¼¹å‡ºå¯†ç éªŒè¯å¯¹è¯æ¡†ã€‚

## å®ç°æ–‡ä»¶ç»“æ„

```
plugins/
â”œâ”€â”€ auth-plugin.ts      # è®¤è¯æ’ä»¶ä¸»æ–‡ä»¶
â”œâ”€â”€ auth-config.ts      # è·¯ç”±ä¿æŠ¤é…ç½®æ–‡ä»¶
â””â”€â”€ AuthGuard.tsx       # è®¤è¯å®ˆå«ç»„ä»¶
types/
â””â”€â”€ virtual-modules.d.ts # TypeScript ç±»å‹å£°æ˜
rspress.config.ts       # å·²æ›´æ–°çš„é…ç½®æ–‡ä»¶
```

## æ ¸å¿ƒå®ç°

### 1. è®¤è¯æ’ä»¶ (`plugins/auth-plugin.ts`)

```typescript
import { RspressPlugin } from '@rspress/shared';
import path from 'path';

export function authPlugin(): RspressPlugin {
  return {
    name: 'auth-plugin',
    globalUIComponents: [path.join(__dirname, 'AuthGuard.tsx')]
  };
}
```

### 2. è·¯ç”±é…ç½® (`plugins/auth-config.ts`)

```typescript
export interface RouteAuthConfig {
  password: string;
  redirectUrl: string;
  title?: string;
  description?: string;
}

export const authConfig: Record<string, RouteAuthConfig> = {
  '/gadgets/Burrata.html': {
    password: 'cheese2024',
    redirectUrl: '/gadgets/Burrata.html',
    title: 'ğŸ§€ Burrata é¡µé¢è®¿é—®å—é™',
    description: 'æ­¤é¡µé¢åŒ…å«ç‰¹æ®Šå†…å®¹ï¼Œéœ€è¦å¯†ç æ‰èƒ½è®¿é—®ã€‚'
  }
};

export const passwordHints: Record<string, string> = {
  '/gadgets/Burrata.html': 'hint: cheese + year',
};
```

### 3. è®¤è¯å®ˆå«ç»„ä»¶ (`plugins/AuthGuard.tsx`)

æ ¸å¿ƒåŠŸèƒ½ï¼š
- âœ… æ£€æµ‹å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦ä¿æŠ¤
- âœ… æ˜¾ç¤ºè‡ªå®šä¹‰å¯†ç è¾“å…¥å¯¹è¯æ¡†
- âœ… éªŒè¯ç”¨æˆ·è¾“å…¥çš„å¯†ç 
- âœ… ç®¡ç†è®¤è¯çŠ¶æ€ï¼ˆä½¿ç”¨ sessionStorageï¼‰
- âœ… éšè—/æ˜¾ç¤ºé¡µé¢å†…å®¹
- âœ… æ”¯æŒè‡ªå®šä¹‰æ ‡é¢˜ã€æè¿°å’Œå¯†ç æç¤º

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨å’Œæµ‹è¯•

1. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**ï¼š
   ```bash
   npm run dev
   ```

2. **æµ‹è¯•åŠŸèƒ½**ï¼š
   - è®¿é—® http://localhost:3000/test.htmlï¼ˆæµ‹è¯•é¡µé¢ï¼‰
   - ç‚¹å‡» "è®¿é—® Burrata é¡µé¢" é“¾æ¥
   - è¾“å…¥å¯†ç  `cheese2024` æ¥è®¿é—®é¡µé¢

### è®¿é—®å—ä¿æŠ¤é¡µé¢

1. ç›´æ¥è®¿é—® http://localhost:3000/gadgets/Burrata.html
2. è¾“å…¥å¯†ç  `cheese2024`
3. è®¤è¯æˆåŠŸåï¼Œåœ¨å½“å‰ä¼šè¯ä¸­å°†ä¿æŒç™»å½•çŠ¶æ€

## åŠŸèƒ½ç‰¹ç‚¹

- âœ… **è·¯ç”±çº§åˆ«çš„è®¿é—®æ§åˆ¶** - ç²¾ç¡®æ§åˆ¶å“ªäº›é¡µé¢éœ€è¦å¯†ç 
- âœ… **å¯†ç éªŒè¯æœºåˆ¶** - å®‰å…¨çš„å¯†ç éªŒè¯
- âœ… **ä¼šè¯çŠ¶æ€ä¿æŒ** - éªŒè¯ååœ¨å½“å‰ä¼šè¯ä¸­ä¿æŒç™»å½•
- âœ… **ä¼˜é›…çš„ç”¨æˆ·ç•Œé¢** - ç¾è§‚çš„æ¨¡æ€å¯¹è¯æ¡†
- âœ… **æ”¯æŒå¤šä¸ªå—ä¿æŠ¤è·¯ç”±** - å¯é…ç½®å¤šä¸ªä¸åŒçš„å—ä¿æŠ¤é¡µé¢
- âœ… **å¯é…ç½®çš„å¯†ç å’Œé‡å®šå‘URL** - çµæ´»çš„é…ç½®é€‰é¡¹
- âœ… **è‡ªå®šä¹‰æ ‡é¢˜å’Œæè¿°** - ä¸ºä¸åŒé¡µé¢å®šåˆ¶æç¤ºä¿¡æ¯
- âœ… **å¯†ç æç¤ºåŠŸèƒ½** - å¯é€‰çš„å¯†ç æç¤ºå¸®åŠ©ç”¨æˆ·

## æ‰©å±•é…ç½®

### æ·»åŠ æ–°çš„å—ä¿æŠ¤è·¯ç”±

åœ¨ `plugins/auth-config.ts` ä¸­æ·»åŠ æ–°çš„æ¡ç›®ï¼š

```typescript
export const authConfig: Record<string, RouteAuthConfig> = {
  '/gadgets/Burrata.html': {
    password: 'cheese2024',
    redirectUrl: '/gadgets/Burrata.html',
    title: 'ğŸ§€ Burrata é¡µé¢è®¿é—®å—é™',
    description: 'æ­¤é¡µé¢åŒ…å«ç‰¹æ®Šå†…å®¹ï¼Œéœ€è¦å¯†ç æ‰èƒ½è®¿é—®ã€‚'
  },
  // æ·»åŠ æ–°çš„å—ä¿æŠ¤è·¯ç”±
  '/secret-docs.html': {
    password: 'my-secret-2024',
    redirectUrl: '/secret-docs.html',
    title: 'ğŸ” æœºå¯†æ–‡æ¡£',
    description: 'æ­¤æ–‡æ¡£åŒ…å«æœºå¯†ä¿¡æ¯ï¼Œéœ€è¦ç‰¹æ®Šæƒé™è®¿é—®ã€‚'
  }
};

// ä¸ºæ–°è·¯ç”±æ·»åŠ å¯†ç æç¤º
export const passwordHints: Record<string, string> = {
  '/gadgets/Burrata.html': 'hint: cheese + year',
  '/secret-docs.html': 'hint: my-secret + year'
};
```

### è‡ªå®šä¹‰æ ·å¼

ä½ å¯ä»¥åœ¨ `AuthGuard.tsx` ä¸­ä¿®æ”¹æ ·å¼é…ç½®æ¥åŒ¹é…ä½ çš„ç½‘ç«™ä¸»é¢˜ã€‚

### å®‰å…¨æ€§è€ƒè™‘

- å¯†ç ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œè¿™ç§æ–¹æ³•é€‚ç”¨äºç®€å•çš„å†…å®¹ä¿æŠ¤
- å¯¹äºçœŸæ­£çš„å®‰å…¨éœ€æ±‚ï¼Œå»ºè®®ä½¿ç”¨æœåŠ¡å™¨ç«¯è®¤è¯
- å½“å‰å®ç°ä¸»è¦ç”¨äºé˜²æ­¢å¶ç„¶è®¿é—®ï¼Œè€Œéå®‰å…¨é˜²æŠ¤

## æŠ€æœ¯å®ç°ç»†èŠ‚

1. **æ’ä»¶ç³»ç»Ÿ**ï¼šä½¿ç”¨ RSPress çš„æ’ä»¶ API æ¥æ³¨å†Œå…¨å±€ç»„ä»¶
2. **è·¯ç”±æ£€æµ‹**ï¼šä½¿ç”¨ `react-router-dom` çš„ `useLocation` hook æ¥ç›‘å¬è·¯ç”±å˜åŒ–
3. **DOM æ“ä½œ**ï¼šé€šè¿‡ JavaScript ç›´æ¥æ“ä½œ DOM æ¥éšè—/æ˜¾ç¤ºé¡µé¢å†…å®¹
4. **çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨ React hooks å’Œ sessionStorage æ¥ç®¡ç†è®¤è¯çŠ¶æ€
5. **TypeScript æ”¯æŒ**ï¼šå®Œæ•´çš„ç±»å‹å®šä¹‰å’Œç±»å‹å®‰å…¨

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **é¡µé¢å†…å®¹ä»ç„¶å¯è§**ï¼š
   - æ£€æŸ¥ DOM é€‰æ‹©å™¨ `.rspress-doc` æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç»„ä»¶æ­£ç¡®åŠ è½½

2. **å¯†ç éªŒè¯å¤±è´¥**ï¼š
   - æ£€æŸ¥ `auth-config.ts` ä¸­çš„å¯†ç é…ç½®
   - ç¡®è®¤è·¯ç”±è·¯å¾„åŒ¹é…æ­£ç¡®

3. **ç»„ä»¶æœªåŠ è½½**ï¼š
   - æ£€æŸ¥æ’ä»¶æ˜¯å¦æ­£ç¡®æ³¨å†Œåœ¨ `rspress.config.ts` ä¸­
   - æŸ¥çœ‹å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### å¼€å‘æ¨¡å¼è°ƒè¯•

åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œä½ å¯ä»¥ï¼š
- æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
- æ£€æŸ¥ sessionStorage ä¸­çš„è®¤è¯çŠ¶æ€
- æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ç¡®è®¤ç»„ä»¶æ­£ç¡®åŠ è½½

---

## å®ŒæˆçŠ¶æ€

âœ… **å®ç°å®Œæˆï¼** 

ä½ ç°åœ¨å¯ä»¥ï¼š
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`npm run dev`
2. è®¿é—® http://localhost:3000/gadgets/Burrata.html
3. è¾“å…¥å¯†ç  `cheese2024` æ¥æµ‹è¯•åŠŸèƒ½

åŠŸèƒ½å·²ç»æˆåŠŸé›†æˆåˆ°ä½ çš„ RSPress é¡¹ç›®ä¸­ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼
